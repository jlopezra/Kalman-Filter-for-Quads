function H=SingleRangeJacobianIQ(Xfilter,P,j,index)
Xk=Xfilter(9*(index-1)+1:9*(index-1)+9,1);
Xj=Xfilter(9*(j-1)+1:9*(j-1)+9,1);

x1=Xk(1);
y1=Xk(2);
z1=Xk(3);


x2=Xj(1);
y2=Xj(2);
z2=Xj(3);

Hr =[ (2*x1 - 2*x2)/(2*((x1 - x2)^2 + (y1 - y2)^2 + (z1 - z2)^2)^(1/2)), (2*y1 - 2*y2)/(2*((x1 - x2)^2 + (y1 - y2)^2 + (z1 - z2)^2)^(1/2)), (2*z1 - 2*z2)/(2*((x1 - x2)^2 + (y1 - y2)^2 + (z1 - z2)^2)^(1/2)), 0, 0, 0, 0, 0, 0, -(2*x1 - 2*x2)/(2*((x1 - x2)^2 + (y1 - y2)^2 + (z1 - z2)^2)^(1/2)), -(2*y1 - 2*y2)/(2*((x1 - x2)^2 + (y1 - y2)^2 + (z1 - z2)^2)^(1/2)), -(2*z1 - 2*z2)/(2*((x1 - x2)^2 + (y1 - y2)^2 + (z1 - z2)^2)^(1/2)), 0, 0, 0, 0, 0, 0];
 

H=zeros(1,9*P.Nq);

H(1,9*(index-1)+1:9*(index-1)+9)=Hr(1:9);
H(1,9*(j-1)+1:9*(j-1)+9)=Hr(10:18);